# ============================================================
# TELEGRAM BOT CONFIGURATION
# ============================================================

# Получить токен у @BotFather в Telegram
TELEGRAM_TOKEN=

EXCHANGERATE_URL=https://v6.exchangerate-api.com/v6/<api-key>/latest/
# ============================================================
# LLM PROVIDER CONFIGURATION
# Выберите один из провайдеров и раскомментируйте нужный блок
# ============================================================

# --- OpenAI (официальный API) ---
# OPENAI_API_KEY=sk-proj-...
# MODEL=gpt-4o
# EMBEDDING_MODEL=text-embedding-3-large
# RAGAS_LLM_MODEL=gpt-4o
# RAGAS_EMBEDDING_MODEL=text-embedding-3-large

# --- OpenRouter (рекомендуется) ---
# https://openrouter.ai/ - доступ к различным моделям
# OPENAI_API_KEY=sk-or-v1-...
# OPENAI_BASE_URL=https://openrouter.ai/api/v1
# MODEL=openai/gpt-4o
# EMBEDDING_MODEL=openai/text-embedding-3-large
# RAGAS_LLM_MODEL=openai/gpt-4o
# RAGAS_EMBEDDING_MODEL=openai/text-embedding-3-large

# --- Fireworks (быстро, но embedding слабее) ---
# https://fireworks.ai/
OPENAI_API_KEY=
OPENAI_BASE_URL=https://api.fireworks.ai/inference/v1
MODEL=accounts/fireworks/models/gpt-oss-120b
RAGAS_LLM_MODEL=accounts/fireworks/models/gpt-oss-120b

RAGAS_EMBEDDING_MODEL=aroxima/multilingual-e5-large-instruct:latest
EMBEDDING_MODEL=aroxima/multilingual-e5-large-instruct:latest

# ============================================================
# PATHS & FILES
# ============================================================

DATA_DIR=data
PROMPTS_DIR=prompts
AGENT_SYSTEM_PROMPT_FILE=agent_system.txt

# ============================================================
# ADVANCED HYBRID RAG CONFIGURATION
# ============================================================

# --- Retrieval Mode ---
# semantic          - векторный поиск по смыслу (по умолчанию)
# hybrid            - Semantic + BM25 (точные термины)
# hybrid_reranker   - Hybrid + Cross-encoder (максимальная точность)
RETRIEVAL_MODE=semantic

# --- Retriever Parameters ---
SEMANTIC_RETRIEVER_K=3
BM25_RETRIEVER_K=3

# --- Ensemble Weights (для hybrid режима) ---
ENSEMBLE_SEMANTIC_WEIGHT=0.5
ENSEMBLE_BM25_WEIGHT=0.5

# --- Cross-Encoder Reranking (для hybrid_reranker режима) ---
CROSS_ENCODER_MODEL=cross-encoder/mmarco-mMiniLMv2-L12-H384-v1
RERANKER_TOP_K=3

# ============================================================
# EMBEDDINGS CONFIGURATION
# ============================================================

# --- Provider ---
# openai      - облачные embeddings (быстрый старт)
# huggingface - локальные модели (приватность, offline)
EMBEDDING_PROVIDER=ollama

# --- HuggingFace Settings (если EMBEDDING_PROVIDER=huggingface) ---
HUGGINGFACE_EMBEDDING_MODEL=aroxima/multilingual-e5-large-instruct:latest
HUGGINGFACE_DEVICE=cpu  # cpu, cuda, mps (Mac M1/M2)

# Отключает параллелизм в tokenizers для избежания предупреждений
# в многопроцессном окружении (aiogram + asyncio)
TOKENIZERS_PARALLELISM=false

# ============================================================
# FEATURES
# ============================================================

# Отображать источники документов в ответах
SHOW_SOURCES=true

# ============================================================
# RAGAS EVALUATION
# ============================================================

# Провайдер embeddings для RAGAS (по умолчанию = EMBEDDING_PROVIDER)
# openai      - OpenAI embeddings (рекомендуется для стабильных метрик)
# huggingface - локальные HuggingFace embeddings
# RAGAS_EMBEDDING_PROVIDER=huggingface

# --- HuggingFace настройки для RAGAS (если RAGAS_EMBEDDING_PROVIDER=huggingface) ---
# По умолчанию использует те же модели что и основные embeddings
# RAGAS_HUGGINGFACE_EMBEDDING_MODEL=intfloat/multilingual-e5-base
# RAGAS_HUGGINGFACE_DEVICE=cpu
# ============================================================
# RATE LIMITING (для предотвращения ошибок слишком частых запросов)
# ============================================================

# Задержка между RAG запросами при evaluation (секунды)
# Увеличьте если получаете ошибки "rate limit exceeded"
EVALUATION_RAG_DELAY=1.5

# Задержка между вычислением RAGAS метрик (секунды)
EVALUATION_METRIC_DELAY=1

# Задержка между созданием embeddings (секунды)
EVALUATION_EMBEDDING_DELAY=0.5

# Задержка между LangSmith API вызовами (секунды)
EVALUATION_LANGSMITH_DELAY=0.5

# ============================================================
# LANGSMITH MONITORING (опционально)
# ============================================================

# Получить API ключ на https://smith.langchain.com
LANGSMITH_API_KEY=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
LANGSMITH_TRACING_V2=true  # или LANGSMITH_TRACING=true (для совместимости)
LANGSMITH_PROJECT=08-raq-agent
LANGSMITH_DATASET=08-rag-qa-dataset

# ============================================================
# SYSTEM PROMPT
# ============================================================

SYSTEM_PROMPT=Ты ассистент Сбербанка, отвечающий на вопросы по документам.
